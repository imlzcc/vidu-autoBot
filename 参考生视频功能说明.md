# 参考生视频功能说明

## 功能概述

在Vidu批量视频生成插件v3.0.0中新增了参考生视频功能，允许用户在图生视频页面一键切换到参考生视频模式，实现批量提交生视频提示词并自动选定主体。

## 主要特性

### 1. 快速切换按钮
- 在图生视频页面显示绿色的"🎯 参考生视频"按钮
- 点击后自动执行一系列操作切换到参考生视频模式
- 在参考生视频页面自动隐藏该按钮

### 2. 自动标签切换
- 自动检测并切换到"参考生视频"标签页
- 无需手动点击页面上的标签

### 3. 自动主体选择
- 自动点击"主体库"按钮选择参考主体
- 确保用户已登录并有权访问主体库功能

### 4. 批量提示词处理
- 支持批量输入提示词生成视频
- 每个提示词生成一个独立的视频
- 无需上传图片文件

### 5. 错峰模式
- 自动启用错峰模式避免系统负载过高
- 提高批量处理的成功率

### 6. 智能UI切换
- 根据页面类型智能显示/隐藏相关功能区域
- 在参考生视频模式下隐藏图片上传区域
- 更新提示词占位符文本

## 使用方法

### 步骤1：打开图生视频页面
访问 https://www.vidu.cn/create/img2video

### 步骤2：点击悬浮球
点击页面右下角的悬浮球图标打开插件面板

### 步骤3：点击参考生视频按钮
在插件面板中找到绿色的"🎯 参考生视频"按钮并点击

### 步骤4：等待自动切换
插件将自动执行以下操作：
- 切换到"参考生视频"标签页
- 点击"主体库"按钮选择参考主体
- 启用错峰模式
- 更新UI界面

### 步骤5：输入提示词
在提示词输入框中输入批量提示词，每行一个：
```
女孩开心地笑了
男孩在公园里跑步
夕阳下的海滩风景
城市夜景灯火通明
```

### 步骤6：开始批量生成
点击"开始处理"按钮开始批量生成视频

## 技术实现

### 文件修改
1. **floating-ball.js**: 添加参考生视频按钮和相关功能
2. **floating-ball.css**: 添加按钮样式
3. **README.md**: 更新文档说明

### 核心方法
- `switchToReferenceMode()`: 切换到参考生视频模式的主方法
- `updateUIForReferenceMode()`: 更新UI为参考生视频模式
- `switchToReferenceTab()`: 切换到参考生视频标签页
- `clickSubjectLibraryButton()`: 点击主体库按钮
- `enableOffPeakMode()`: 启用错峰模式

### UI组件
- 参考生视频按钮：绿色渐变背景，带悬停效果
- 功能提示文本：说明按钮的作用
- 智能显示/隐藏：根据页面类型控制显示

## 注意事项

1. **登录要求**: 需要先登录Vidu账户并确保有权访问主体库功能
2. **页面兼容性**: 仅在Vidu图生视频页面生效
3. **网络稳定性**: 建议在稳定的网络环境下使用
4. **批量限制**: 注意Vidu平台的批量处理限制

## 测试验证

创建了测试页面 `test-reference.html` 用于功能验证，包含：
- 功能特性说明
- 测试步骤指导
- 注意事项提醒

## 版本信息

- 版本：v3.0.0
- 新增功能：参考生视频模式
- 兼容性：Chrome 88+, Edge 88+
- 依赖：Vidu平台主体库功能
