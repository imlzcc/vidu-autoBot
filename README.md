# Vidu 悬浮球批量视频生成插件

一个强大的Chrome浏览器扩展，专为Vidu视频生成平台设计，支持批量上传图片和提示词，实现自动化视频生成流程。

## 功能特性

### 📁 文件读取功能
- **图片支持**: jpg、png、webp格式
- **分镜识别**: 自动根据文件名排序（支持数字序号如1、2、3或shot_1、shot_2格式）
- **Prompt文档**: 支持txt格式，一行一条视频生成提示词
- **文件夹选择**: 支持选择包含图片和Prompt文件的文件夹

### 🚀 批量处理功能
- **自动提交**: 自动上传图片并输入对应的Prompt
- **双重模式**: 排队模式 & 智能检测模式
- **智能检测**: 自动检测创作按钮状态，无需固定等待时间
- **进度跟踪**: 实时显示处理进度和状态
- **错误处理**: 自动跳过失败的任务，继续处理后续任务

### 🎯 参考生视频功能 (v3.0.0新增)
- **快速切换**: 在图生视频页面一键切换到参考生视频模式
- **自动标签切换**: 自动切换到"参考生视频"标签页
- **主体库选择**: 自动点击"主体库"按钮选择参考主体
- **批量提示词**: 支持批量输入提示词生成视频（无需上传图片）
- **错峰模式**: 自动启用错峰模式避免系统负载过高
- **智能UI**: 根据页面类型智能显示/隐藏相关功能区域

### 🎬 视频生成设置 (v3.0.0新增)
- **宽高比选择**: 支持9:16、16:9、1:1、4:3、3:4等多种宽高比
- **错峰模式控制**: 可在插件中直接开启/关闭错峰模式
- **生成数量设置**: 支持设置每次生成1-4个视频
- **自动应用设置**: 切换到参考生视频模式时自动应用这些设置
- **设置持久化**: 所有设置会自动保存，下次使用时保持

### ⚙️ 设置选项
- **处理模式**: 
  - 排队模式：每处理4个视频后自动等待2分钟（可自定义）
  - 智能检测模式：检测创作按钮状态，每8秒检查一次（可自定义）
- **批量大小**: 可设置每批处理的视频数量（1-10个）
- **等待时间**: 可设置批次间的等待时间（1-10分钟）
- **检测间隔**: 智能模式下检测创作按钮的间隔时间（3-30秒）
- **最大重试**: 智能模式下最大重试次数（1-20次）

## 安装方法

1. 下载插件文件到本地文件夹
2. 打开Chrome浏览器，进入扩展程序管理页面 (`chrome://extensions/`)
3. 开启"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择插件文件夹

## 使用方法

### 1. 准备文件
在本地文件夹中准备以下文件：
- **图片文件**: 命名为 `1.jpg`, `2.png`, `shot_1.webp` 等格式
- **Prompt文件**: 创建 `.txt` 文件，每行一个视频生成提示词

示例文件结构：
```
project_folder/
├── 1.jpg
├── 2.png  
├── 3.webp
├── shot_4.jpg
└── prompts.txt
```

示例 `prompts.txt` 内容：
```
女孩开心地笑了
男孩在公园里跑步
夕阳下的海滩风景
城市夜景灯火通明
```

### 2. 使用插件

#### 图生视频模式
1. 打开 [Vidu图生视频页面](https://www.vidu.cn/create/img2video)
2. 点击浏览器工具栏中的插件图标
3. 在弹出窗口中点击"选择包含图片和Prompt的文件夹"
4. 选择准备好的文件夹
5. 检查文件预览，确认图片和Prompt匹配
6. 选择处理模式：
   - **排队模式**：适合稳定的批量处理，每4个视频后等待
   - **智能检测模式**：适合不确定生成时间的场景，自动检测按钮状态
7. 调整相应模式的设置参数（可选）
8. 点击"开始批量处理"

#### 参考生视频模式 (v3.0.0新增)
1. 打开 [Vidu图生视频页面](https://www.vidu.cn/create/img2video)
2. 点击浏览器工具栏中的插件图标
3. 在"视频生成设置"区域中配置参数：
   - 选择宽高比（如9:16竖屏、16:9横屏等）
   - 开启/关闭错峰模式
   - 设置生成数量（1-4个）
4. 点击绿色的"🎯 参考生视频"按钮
5. 插件将自动：
   - 切换到"参考生视频"标签页
   - 点击"主体库"按钮选择参考主体
6. 在插件面板的提示词输入框中输入批量提示词（每行一个）
7. 点击"开始处理"按钮，插件将：
   - 自动应用您设置的宽高比、错峰模式和生成数量
   - 在左侧主页面输入每个提示词
   - 点击左侧的"创作"按钮提交任务
   - 等待提交完成后处理下一个任务

### 3. 监控进度
- 实时查看处理状态和进度条
- 查看详细的处理日志
- 如需停止，点击"停止处理"按钮

## 技术实现

### 文件结构
```
vidu-extension/
├── manifest.json          # 插件配置文件
├── popup.html             # 弹出窗口界面
├── popup.css              # 界面样式
├── popup.js               # 界面逻辑
├── content.js             # 网页交互脚本
├── background.js          # 后台服务脚本
├── icons/                 # 插件图标
│   ├── icon16.svg
│   ├── icon48.svg
│   └── icon128.svg
└── README.md              # 说明文档
```

### 核心功能
- **文件系统访问**: 使用File System Access API读取本地文件
- **DOM操作**: 通过Content Script与Vidu网站交互
- **消息传递**: 使用Chrome Extension API在不同脚本间通信
- **存储管理**: 使用Chrome Storage API保存用户设置

## 注意事项

⚠️ **重要提醒**:
- 请确保在使用前已登录Vidu账户
- 建议在网络稳定的环境下使用
- 大批量处理时请注意Vidu平台的使用限制
- 插件仅在 `https://www.vidu.cn/create/img2video` 页面生效

## 故障排除

### 常见问题
1. **无法选择文件夹**: 请使用支持File System Access API的现代浏览器
2. **上传失败**: 检查图片格式是否支持，文件大小是否过大
3. **Prompt输入失败**: 确认Prompt文本编码为UTF-8
4. **创作按钮无响应**: 检查是否已正确上传图片和输入Prompt

### 兼容性
- Chrome 88+
- Edge 88+
- 其他基于Chromium的浏览器

## 版本历史

### v3.0.0 (最新)
- 🎯 新增参考生视频功能，支持一键切换到参考生视频模式
- 🔄 自动标签切换：自动切换到"参考生视频"标签页
- 👤 自动主体选择：自动点击"主体库"按钮选择参考主体
- 📝 批量提示词处理：支持批量输入提示词生成视频（无需上传图片）
- ⚡ 错峰模式：自动启用错峰模式避免系统负载过高
- 🎨 智能UI切换：根据页面类型智能显示/隐藏相关功能区域
- 🎬 视频生成设置：新增宽高比、错峰模式、生成数量等设置选项
- 🔧 自动应用设置：切换到参考生视频模式时自动应用所有设置
- 💾 设置持久化：所有设置自动保存，下次使用时保持

### v2.0.1
- ✨ 新增智能检测模式，自动检测创作按钮状态
- 🎨 优化UI界面，解决白色文字显示问题
- ⚙️ 双重处理模式：排队模式 & 智能检测模式
- 🔧 可配置的检测间隔和重试次数
- 🎯 使用精确的CSS选择器优化按钮检测

### v1.0.0
- 初始版本发布
- 支持批量图片上传和Prompt输入
- 实现排队等候功能
- 添加进度跟踪和日志记录

## 许可证

本项目仅供学习和个人使用，请遵守Vidu平台的使用条款。

## 📦 安装包下载

### 从GitHub下载
1. 访问 [GitHub仓库](https://github.com/your-username/vidu-batch-video-generator)
2. 点击 "Code" -> "Download ZIP"
3. 解压到本地文件夹
4. 按照上述安装方法加载插件

### 从源码构建
```bash
git clone https://github.com/your-username/vidu-batch-video-generator.git
cd vidu-batch-video-generator
# 直接加载到Chrome扩展程序
```

## 🤝 贡献指南

欢迎提交Issue和Pull Request来帮助改进这个项目！

1. Fork 此仓库
2. 创建您的特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交您的更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 打开一个Pull Request

## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情

## 支持

如有问题或建议，请通过以下方式联系：
- 提交Issue到 [GitHub仓库](https://github.com/your-username/vidu-batch-video-generator/issues)
- 发送邮件至开发者邮箱

---

**免责声明**: 本插件为第三方工具，与Vidu官方无关。使用时请遵守相关平台的服务条款。